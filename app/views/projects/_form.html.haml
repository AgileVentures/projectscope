= form_for(@project) do |f|
  - if @project.errors.any?
    #error_explanation
      %h2 #{pluralize(@project.errors.count, "error")} prohibited this project from being saved:

      %ul
        - @project.errors.full_messages.each do |message|
          %li= message

  .field
    = f.label :name
    %br
    = f.text_field :name, :disabled => @readonly

  = f.fields_for :configs do |cf|
    - name = cf.object.metric_name
    %fieldset
      %legend= name.humanize.capitalize
      - cf.object.options.each_pair do |key,val|
        - field_name = "project[configs_attributes][#{cf.index}][options][#{key}]"
        %label{:for => field_name}= "#{key}:"
        = text_field_tag field_name, val, :disabled => @readonly
        %br
      - unless @readonly
        %label Add new config keys and values:
        %br
        = text_field_tag "project[configs_attributes][#{cf.index}][new][]", ''
        \ :
        = text_field_tag "project[configs_attributes][#{cf.index}][new][]", ''
        %br
        = text_field_tag "project[configs_attributes][#{cf.index}][new][]", ''
        \ :
        = text_field_tag "project[configs_attributes][#{cf.index}][new][]", ''

  - unless @readonly
    .actions
      = f.submit
